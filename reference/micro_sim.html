<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulates microsatellite data across a pedigree. — micro_sim • pedtricks</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulates microsatellite data across a pedigree. — micro_sim"><meta name="description" content="Uses a pedigree with parents identified for all non-founding
individuals and simulates microsatellite genotypes"><meta property="og:description" content="Uses a pedigree with parents identified for all non-founding
individuals and simulates microsatellite genotypes"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pedtricks</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JulienGAMartin/pedtricks/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulates microsatellite data across a pedigree.</h1>
      <small class="dont-index">Source: <a href="https://github.com/JulienGAMartin/pedtricks/blob/main/R/micro_sim.R" class="external-link"><code>R/micro_sim.R</code></a></small>
      <div class="d-none name"><code>micro_sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses a pedigree with parents identified for all non-founding
individuals and simulates microsatellite genotypes</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">micro_sim</span><span class="op">(</span></span>
<span>  <span class="va">pedigree</span>,</span>
<span>  genFreqs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genotypesSample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  knownGenotypes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  records <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eRate1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  eRate2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  eRate3 <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pedigree">pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>A pedigree</p></dd>


<dt id="arg-genfreqs">genFreqs<a class="anchor" aria-label="anchor" href="#arg-genfreqs"></a></dt>
<dd><p>(optional) A list of allele frequencies, can be produced with <code>extractA</code></p></dd>


<dt id="arg-genotypessample">genotypesSample<a class="anchor" aria-label="anchor" href="#arg-genotypessample"></a></dt>
<dd><p>(required if <code>genFreqs</code> is not supplied) a sample of genotypes from which to estimate population allele frequencies</p></dd>


<dt id="arg-knowngenotypes">knownGenotypes<a class="anchor" aria-label="anchor" href="#arg-knowngenotypes"></a></dt>
<dd><p>(not yet implemented) a data frame of genotypes for (potentially a subset) of founder individuals</p></dd>


<dt id="arg-records">records<a class="anchor" aria-label="anchor" href="#arg-records"></a></dt>
<dd><p>Record availability, see details.</p></dd>


<dt id="arg-erate-">eRate1<a class="anchor" aria-label="anchor" href="#arg-erate-"></a></dt>
<dd><p>The rate of genotypic substitution errors, i.e., when a true genotype at a given locus is replaced by a pair of alleles selected at random based on the population allele frequencies</p></dd>


<dt id="arg-erate-">eRate2<a class="anchor" aria-label="anchor" href="#arg-erate-"></a></dt>
<dd><p>The rate of allelic substitution errors, i.e. when an allele is erroneously replaced at a given locus by an allele chosen at random based on the population allele frequencies</p></dd>


<dt id="arg-erate-">eRate3<a class="anchor" aria-label="anchor" href="#arg-erate-"></a></dt>
<dd><p>The rate of large allele dropouts, simulated by setting the value of the larger allele at a locus to the value of the smaller allele</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>trueGenotypes</dt>
<dd><p>A data frame of true genotypes</p></dd>

<dt>observedGenotypes</dt>
<dd><p>A data frame of plausible observed genotypes, given specified patterns of missingness and errors.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Error rates and data availability rates can be specified as either (1) single values to be applied to all individuals and all loci, (2) as a vector the same length as the number of loci, representing locus-specific rates to be applied uniformly to all individuals, or (3) as data frames with rows for each individual and columns for each locus.  In the third option, observed patterns of data availability can be simulated by supplying 0s and 1s for missing and available individual genotypes, respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="phen_sim.html">phen_sim</a></code>, <code><a href="genome_sim.html">genome_sim</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pedigree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"m1"</span>,   <span class="cn">NA</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"m2"</span>,   <span class="cn">NA</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"m3"</span>,   <span class="cn">NA</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"d4"</span>,   <span class="cn">NA</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"d5"</span>,   <span class="cn">NA</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o6"</span>,   <span class="st">"m1"</span>,   <span class="st">"d4"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o7"</span>,   <span class="st">"m1"</span>,   <span class="st">"d4"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o8"</span>,   <span class="st">"m1"</span>,   <span class="st">"d4"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o9"</span>,   <span class="st">"m1"</span>,   <span class="st">"d4"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o10"</span>,  <span class="st">"m2"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o11"</span>,  <span class="st">"m2"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o12"</span>,  <span class="st">"m2"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o13"</span>,  <span class="st">"m2"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o14"</span>,  <span class="st">"m3"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o15"</span>,  <span class="st">"m3"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o16"</span>,  <span class="st">"m3"</span>,   <span class="st">"d5"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"o17"</span>,  <span class="st">"m3"</span>,   <span class="st">"d5"</span></span></span>
<span class="r-in"><span><span class="op">)</span>, <span class="fl">17</span>, <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pedigree</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"dam"</span>, <span class="st">"sire"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">x</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="va">pedigree</span><span class="op">[</span>, <span class="va">x</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">pedigree</span><span class="op">[</span>, <span class="va">x</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## some sample genotypes, very simple, two markers with He = 0.5</span></span></span>
<span class="r-in"><span><span class="va">sampleGenotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## locus names</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sampleGenotypes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loc1a"</span>, <span class="st">"loc1b"</span>, <span class="st">"loc2a"</span>, <span class="st">"loc2b"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## simulate some genotypes</span></span></span>
<span class="r-in"><span><span class="fu">micro_sim</span><span class="op">(</span>pedigree <span class="op">=</span> <span class="va">pedigree</span>, genotypesSample <span class="op">=</span> <span class="va">sampleGenotypes</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trueGenotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     loc1b loc1b_b loc2b loc2b_b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m1      1       2     2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m2      1       2     2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m3      1       1     1       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4      2       1     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d5      1       1     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o6      1       2     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o7      2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o8      2       2     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o9      1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o10     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o11     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o12     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o13     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o14     1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o15     1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o16     1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o17     1       1     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $observedGenotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     loc1b loc1b_b loc2b loc2b_b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m1      1       2     2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m2      1       2     2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m3      1       1     1       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4      2       1     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d5      1       1     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o6      1       2     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o7      2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o8      2       2     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o9      1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o10     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o11     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o12     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o13     2       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o14     1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o15     1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o16     1       1     2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o17     1       1     1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julien Martin, Matthew Wolak, Susan Johnston, Michael Morrissey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

