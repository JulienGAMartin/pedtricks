<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>A function to simulated phenotypic data — phen_sim • pedtricks</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A function to simulated phenotypic data — phen_sim"><meta name="description" content="Simulates phenotypic data across arbitrary pedigrees.   phen_sim simulate direct, maternal and paternal genetic and environmental effects for an arbitrary number of traits with arbitrary patterns of missing data."><meta property="og:description" content="Simulates phenotypic data across arbitrary pedigrees.   phen_sim simulate direct, maternal and paternal genetic and environmental effects for an arbitrary number of traits with arbitrary patterns of missing data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pedtricks</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JulienGAMartin/pedtricks/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A function to simulated phenotypic data</h1>
      <small class="dont-index">Source: <a href="https://github.com/JulienGAMartin/pedtricks/blob/v0.4.2/R/phen_sim.R" class="external-link"><code>R/phen_sim.R</code></a></small>
      <div class="d-none name"><code>phen_sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates phenotypic data across arbitrary pedigrees.  <code> phen_sim</code> simulate direct, maternal and paternal genetic and environmental effects for an arbitrary number of traits with arbitrary patterns of missing data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">phen_sim</span><span class="op">(</span></span>
<span>  <span class="va">pedigree</span>,</span>
<span>  traits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  randomA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  randomE <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parentalA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parentalE <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sampled <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  records <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnAllEffects <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pedigree">pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>A pedigree</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>The number of traits for which data should be simulated.</p></dd>


<dt id="arg-randoma">randomA<a class="anchor" aria-label="anchor" href="#arg-randoma"></a></dt>
<dd><p>An additive genetic covariance matrix, with dimensions a multiple of traits - see details</p></dd>


<dt id="arg-randome">randomE<a class="anchor" aria-label="anchor" href="#arg-randome"></a></dt>
<dd><p>An additive environmental covariance matrix, with dimensions a multiple of traits - see details</p></dd>


<dt id="arg-parentala">parentalA<a class="anchor" aria-label="anchor" href="#arg-parentala"></a></dt>
<dd><p>A vector indicating which effects in <code>randomA</code> (if any) to treat as parental effects</p></dd>


<dt id="arg-parentale">parentalE<a class="anchor" aria-label="anchor" href="#arg-parentale"></a></dt>
<dd><p>A vector indicating which effects in <code>randomE</code> (if any) to treat as parental effects</p></dd>


<dt id="arg-sampled">sampled<a class="anchor" aria-label="anchor" href="#arg-sampled"></a></dt>
<dd><p>A vector indicating which individuals are sampled</p></dd>


<dt id="arg-records">records<a class="anchor" aria-label="anchor" href="#arg-records"></a></dt>
<dd><p>A single value, array of matrix specifying data record availability - see details</p></dd>


<dt id="arg-returnalleffects">returnAllEffects<a class="anchor" aria-label="anchor" href="#arg-returnalleffects"></a></dt>
<dd><p>If <code>TRUE</code> then all individual breeding values and environmental effects are returned</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code> provide a progress bar and messages, Default: TRUE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>phenotypes</dt>
<dd><p>A dataframe containing phenotypes for all individuals specified to have records.</p></dd>

<dt>allEffects</dt>
<dd><p>(optional) A dataframe with all direct and indirect genetic and environmental effects.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>randomA</code> and <code>randomE</code> are square matrices with dimension equal to the sum of the number direct and indirect effects.  This must be a multiple of the number of traits, i.e. if an indirect effect is to be simulated for only one of multiple traits, those traits with no indirect effect should be included with (co)variances of zero.</p>
<p><code>parentalA</code> and <code>parentalE</code> are optional vectors of characters indicating which trait positions in <code>randomA</code> and <code>randomE</code> are to be treated as indirect effects, and which effects to treat as maternal or paternal.  Valid values are 'd', 'm', and 'p', for direct, maternal indirect and paternal indirect effects, respectively.</p>
<p><code>records</code> can be specified either (1) as a single value to be applied to all individuals and traits, (2) as a vector the same length as the number of traits, representing trait-specific rates to be applied uniformly to all individuals, or (3) as data frames with rows for each individual and columns for each trait.  In the third option, observed patterns of data availability can be simulated by supplying 0s and 1s for missing and available individual genotypes, respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="micro_sim.html">micro_sim</a></code>, <code><a href="genome_sim.html">genome_sim</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## make up a pedigree</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a1"</span>, <span class="st">"a2"</span>, <span class="st">"a3"</span>, <span class="st">"a4"</span>, <span class="st">"a5"</span>, <span class="st">"a6"</span>, <span class="st">"a7"</span>, <span class="st">"a8"</span>, <span class="st">"a9"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"a1"</span>, <span class="st">"a1"</span>, <span class="st">"a1"</span>, <span class="st">"a4"</span>, <span class="st">"a4"</span>, <span class="st">"a4"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sire</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"a2"</span>, <span class="st">"a2"</span>, <span class="st">"a2"</span>, <span class="st">"a5"</span>, <span class="st">"a6"</span>, <span class="st">"a6"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pedigree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">sire</span>, <span class="va">dam</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="co">## no correlations</span></span></span>
<span class="r-in"><span><span class="va">randomA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">randomE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parentalA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"d"</span>, <span class="st">"m"</span>, <span class="st">"m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parentalE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"d"</span>, <span class="st">"m"</span>, <span class="st">"m"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate phenoypic data based on this architecture</span></span></span>
<span class="r-in"><span><span class="fu">phen_sim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  pedigree <span class="op">=</span> <span class="va">pedigree</span>, traits <span class="op">=</span> <span class="fl">2</span>, randomA <span class="op">=</span> <span class="va">randomA</span>, randomE <span class="op">=</span> <span class="va">randomE</span>,</span></span>
<span class="r-in"><span>  parentalA <span class="op">=</span> <span class="va">parentalA</span>, parentalE <span class="op">=</span> <span class="va">parentalE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Simulating breeding values and environmental effects...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating phenotypes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $phenotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id      trait_1    trait_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1 a1  0.635630356  2.5303279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a2 a2  0.573565965  1.6102071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a3 a3 -0.821761510 -1.1875030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a4 a4 -0.008898436  2.3850244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a5 a5  1.896592223  3.3994600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a6 a6  2.581344532  0.8592014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a7 a7  2.887748532  1.9672431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a8 a8  2.682974192  0.9062174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a9 a9  1.474571866  2.2015559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## let's do it again but see how the phenotypes were composed</span></span></span>
<span class="r-in"><span><span class="fu">phen_sim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  pedigree <span class="op">=</span> <span class="va">pedigree</span>, traits <span class="op">=</span> <span class="fl">2</span>, randomA <span class="op">=</span> <span class="va">randomA</span>, randomE <span class="op">=</span> <span class="va">randomE</span>,</span></span>
<span class="r-in"><span>  parentalA <span class="op">=</span> <span class="va">parentalA</span>, parentalE <span class="op">=</span> <span class="va">parentalE</span>, returnAllEffects <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Simulating breeding values and environmental effects...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating phenotypes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $phenotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id    trait_1    trait_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1 a1 -0.4099814 -0.2708281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a2 a2 -0.8987986  4.0180170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a3 a3 -2.0619251  0.4699000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a4 a4  0.5101248  1.7330805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a5 a5  3.1419989  2.2318840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a6 a6 -2.0368235  0.8033704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a7 a7 -0.1579793  0.1603304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a8 a8 -0.9392673 -1.7291288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a9 a9 -3.5522131  0.5295370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $allEffects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id sire  dam      a_tr1      a_tr2   bv_m_tr1   bv_m_tr2       e_tr1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1 a1 &lt;NA&gt; &lt;NA&gt;  1.4974139 -0.3028269 -1.3768313  0.8831702  0.11062832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a2 a2 &lt;NA&gt; &lt;NA&gt;  0.6714203  1.2300224  1.6454679 -0.1829260 -0.05961225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a3 a3 &lt;NA&gt; &lt;NA&gt; -1.3792578  1.2506006 -1.8762368 -0.3687876 -0.57938809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a4 a4   a2   a1 -0.4212235  0.7023495 -0.9790743  0.2113033  0.73325992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a5 a5   a2   a1  1.7314623  1.2263090  1.1616050 -0.8189242  1.21244833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a6 a6   a2   a1 -0.8685181  0.6505350  0.8587998 -0.1159925 -1.36639361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a7 a7   a5   a4  0.3819610  0.7928566  0.2472483 -1.3510993  0.69450905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a8 a8   a6   a4 -0.1324367 -1.0047145 -0.1063885 -0.2844761  0.42761881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a9 a9   a6   a4 -0.8432258  1.0829131 -0.2055727  0.2137410 -1.47453793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         e_tr2    e_m_tr1     e_m_tr2 P_bv_m_tr1 P_bv_m_tr2  P_e_m_tr1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1  0.2742022  1.5749196  0.56776783 -0.9014624  0.5380665 -1.1165613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a2 -0.1495877  0.2661688  0.52840324  0.5204204  0.1868176 -2.0310270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a3  0.9421994 -0.7063614 -1.27540210 -0.8440720 -0.4520918  0.7407928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a4 -0.4202071 -0.2553751 -0.36923822 -1.3768313  0.8831702  1.5749196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a5 -0.4453630  1.1386675  0.19052348 -1.3768313  0.8831702  1.5749196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a6 -1.2981026 -2.1370983 -0.09620553 -1.3768313  0.8831702  1.5749196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a7 -0.4745912  1.7631306  2.02584606 -0.9790743  0.2113033 -0.2553751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a8 -0.5664793 -0.8338353  0.39825915 -0.9790743  0.2113033 -0.2553751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a9 -0.3954412 -0.1307025 -1.99949395 -0.9790743  0.2113033 -0.2553751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     P_e_m_tr2   Phen_tr1   Phen_tr2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1 -0.7802699 -0.4099814 -0.2708281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a2  2.7507648 -0.8987986  4.0180170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a3 -1.2708082 -2.0619251  0.4699000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a4  0.5677678  0.5101248  1.7330805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a5  0.5677678  3.1419989  2.2318840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a6  0.5677678 -2.0368235  0.8033704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a7 -0.3692382 -0.1579793  0.1603304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a8 -0.3692382 -0.9392673 -1.7291288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a9 -0.3692382 -3.5522131  0.5295370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julien Martin, Matthew Wolak, Susan Johnston, Michael Morrissey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

