<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Produce a graphical representation of a pedigree — draw_ped • pedtricks</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Produce a graphical representation of a pedigree — draw_ped"><meta name="description" content="Plots a pedigree, with options specific to considerations for pedigrees used
to for quantitative genetic inference in natural populations.  Pedigrees
containing only those individuals that are informative with respect to
(genetic) variation in an arbitrary trait can be plotted, potentially
overlain on a complete pedigree.
Functions also exist to plot various types of pedigree links associated with
focal individuals."><meta property="og:description" content="Plots a pedigree, with options specific to considerations for pedigrees used
to for quantitative genetic inference in natural populations.  Pedigrees
containing only those individuals that are informative with respect to
(genetic) variation in an arbitrary trait can be plotted, potentially
overlain on a complete pedigree.
Functions also exist to plot various types of pedigree links associated with
focal individuals."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pedtricks</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JulienGAMartin/pedtricks/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Produce a graphical representation of a pedigree</h1>
      <small class="dont-index">Source: <a href="https://github.com/JulienGAMartin/pedtricks/blob/v0.3.2/R/draw_ped.R" class="external-link"><code>R/draw_ped.R</code></a></small>
      <div class="d-none name"><code>draw_ped.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots a pedigree, with options specific to considerations for pedigrees used
to for quantitative genetic inference in natural populations.  Pedigrees
containing only those individuals that are informative with respect to
(genetic) variation in an arbitrary trait can be plotted, potentially
overlain on a complete pedigree.
Functions also exist to plot various types of pedigree links associated with
focal individuals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">draw_ped</span><span class="op">(</span></span>
<span>  <span class="va">Ped</span>,</span>
<span>  cohorts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dots <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  plotfull <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  writeCohortLabels <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  links <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  sexInd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  dotSize <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  dataDots <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  dataDots.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  cohortLabs.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  retain <span class="op">=</span> <span class="st">"informative"</span>,</span>
<span>  focal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sexColours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ped">Ped<a class="anchor" aria-label="anchor" href="#arg-ped"></a></dt>
<dd><p>An ordered pedigree with 3 columns: id, dam, sire</p></dd>


<dt id="arg-cohorts">cohorts<a class="anchor" aria-label="anchor" href="#arg-cohorts"></a></dt>
<dd><p>An optional numeric vector of the same length as the pedigree
designating, for example cohort affinities or birth years</p></dd>


<dt id="arg-sex">sex<a class="anchor" aria-label="anchor" href="#arg-sex"></a></dt>
<dd><p>An optional numeric vector of the same length as the pedigree
containing the sexes (may be unknown) of all individuals with entries in the
pedigree.  Defaults (modifiable with <code>sexInd</code>) are 0=male and 1=female</p></dd>


<dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>An optional vector or data frame containing indicators of data availability.  If dat contains only ones and zeros, then any individual with any entry of one will be considered as having data records.  If data contains values other than ones and zeros, individuals in the pedigree with rows in data that contain at least one available record, i.e., one data record is not NA, will be treated as having data.</p></dd>


<dt id="arg-dots">dots<a class="anchor" aria-label="anchor" href="#arg-dots"></a></dt>
<dd><p>If 'y', then a dot will be printed representing each individual in the pedigree.  If sexes are available, dots will be colour coded by sex.</p></dd>


<dt id="arg-plotfull">plotfull<a class="anchor" aria-label="anchor" href="#arg-plotfull"></a></dt>
<dd><p>To be used when dat is supplied.  If 'y' (the default), individuals in the pedigree that are uninformative with respect to the available data have their pedigree links plotted in gray.</p></dd>


<dt id="arg-writecohortlabels">writeCohortLabels<a class="anchor" aria-label="anchor" href="#arg-writecohortlabels"></a></dt>
<dd><p>To be used when cohorts is used.  Will plot the cohort values on the left hand side of the pedigree image.</p></dd>


<dt id="arg-links">links<a class="anchor" aria-label="anchor" href="#arg-links"></a></dt>
<dd><p>Default is 'all', other values are 'mums' to print only maternal pedigree links and 'dads' to print only paternal pedigree links.</p></dd>


<dt id="arg-sexind">sexInd<a class="anchor" aria-label="anchor" href="#arg-sexind"></a></dt>
<dd><p>To be used with if sex is supplied and if the vector of sex specifiers differs from the default.</p></dd>


<dt id="arg-dotsize">dotSize<a class="anchor" aria-label="anchor" href="#arg-dotsize"></a></dt>
<dd><p>Set the dot size bigger or smaller</p></dd>


<dt id="arg-datadots">dataDots<a class="anchor" aria-label="anchor" href="#arg-datadots"></a></dt>
<dd><p>Will print dots over the dots denoting individuals, but denoting individuals with available data as indicated by dat.</p></dd>


<dt id="arg-datadots-cex">dataDots.cex<a class="anchor" aria-label="anchor" href="#arg-datadots-cex"></a></dt>
<dd><p>controls the size of dataDots relative to dots.</p></dd>


<dt id="arg-cohortlabs-cex">cohortLabs.cex<a class="anchor" aria-label="anchor" href="#arg-cohortlabs-cex"></a></dt>
<dd><p>controls the size of cohort labels.</p></dd>


<dt id="arg-retain">retain<a class="anchor" aria-label="anchor" href="#arg-retain"></a></dt>
<dd><p>When those pedigree links only informative relative to phenotypic data availability are to be plotted, this controls whether or not a pruned pedigree based on phenotypic data is plotted (if set to "pruned"), or whether strictly only those informative pedigree links are plotted (the default)</p></dd>


<dt id="arg-focal">focal<a class="anchor" aria-label="anchor" href="#arg-focal"></a></dt>
<dd><p>An optional list containing the id of an individual and the kinds of relatives of the focal individual to which to plot pedigree links.  Available types are 'offspring','descendants','parents',,ancestors', and 'kin'.</p></dd>


<dt id="arg-sexcolours">sexColours<a class="anchor" aria-label="anchor" href="#arg-sexcolours"></a></dt>
<dd><p>The colours that will be used to draw points and or lines associated with males and females.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional graphical parameters.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fix_ped.html">fix_ped</a></code> to prepare pedigrees that may not explicitly contain records for all individuals (i.e., where founding individuals may only appear in the dam or sire column).)</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Morrissey <a href="mailto:michael.morrissey@st-andrews.ac.uk">michael.morrissey@st-andrews.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gryphons</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pedigree</span> <span class="op">&lt;-</span> <span class="fu"><a href="fix_ped.html">fix_ped</a></span><span class="op">(</span><span class="va">gryphons</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## draw the gryphon pedigree by pedigree depth</span></span></span>
<span class="r-in"><span><span class="fu">draw_ped</span><span class="op">(</span><span class="va">pedigree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## draw the gryphon pedigree by cohort</span></span></span>
<span class="r-in"><span><span class="fu">draw_ped</span><span class="op">(</span><span class="va">pedigree</span>,</span></span>
<span class="r-in"><span>  cohorts <span class="op">=</span> <span class="va">gryphons</span><span class="op">$</span><span class="va">cohort</span>, writeCohortLabels <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  cohortLabs.cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## draw the gryphon pedigree by cohort with only maternal links</span></span></span>
<span class="r-in"><span><span class="fu">draw_ped</span><span class="op">(</span><span class="va">pedigree</span>, cohorts <span class="op">=</span> <span class="va">gryphons</span><span class="op">$</span><span class="va">cohort</span>, links <span class="op">=</span> <span class="st">"mums"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## draw the gryphon pedigree by cohort with colour only for those</span></span></span>
<span class="r-in"><span><span class="co">## indiduals that are informative relative to the quantitative</span></span></span>
<span class="r-in"><span><span class="co">## genetics of a hypothetical trait only measured for individuals</span></span></span>
<span class="r-in"><span><span class="co">## in the last two cohorts, emphasize the phenotyped individuals</span></span></span>
<span class="r-in"><span><span class="co">## with large black dots, and all other individuals with dots</span></span></span>
<span class="r-in"><span><span class="co">## colour coded by sex:</span></span></span>
<span class="r-in"><span><span class="va">dataAvailability</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">gryphons</span><span class="op">$</span><span class="va">cohort</span> <span class="op">&gt;=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">gryphons</span><span class="op">$</span><span class="va">cohort</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">draw_ped</span><span class="op">(</span><span class="va">pedigree</span>,</span></span>
<span class="r-in"><span>  cohorts <span class="op">=</span> <span class="va">gryphons</span><span class="op">$</span><span class="va">cohort</span>, sex <span class="op">=</span> <span class="va">gryphons</span><span class="op">$</span><span class="va">sex</span>,</span></span>
<span class="r-in"><span>  dots <span class="op">=</span> <span class="st">"y"</span>, dat <span class="op">=</span> <span class="va">dataAvailability</span>, writeCohortLabels <span class="op">=</span> <span class="st">"y"</span>, dataDots <span class="op">=</span> <span class="st">"y"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw_ped-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individuals in full pedigree: 4918 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individuals in informative pedigree subset: 721 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julien Martin, Matthew Wolak, Susan Johnston, Michael Morrissey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

